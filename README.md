# GroupCast
Dify on WeChat项目插件，支持将群聊消息在不同的共享群组内部进行广播转发。

支持配置多个共享群组，每个共享群组可以设置不同的群名关键词，消息只在同一共享群组内的群聊之间转发。

>注意，需要在**机器人的微信账号**上把广播微信群**保存到通讯录**


## 功能特点

- 支持配置多个独立的共享群组
- 群聊消息只在同一共享群组内转发
- 可配置消息转发间隔时间
- 支持忽略@机器人的消息
- 消息转发带有发送者和来源群信息
- 使用消息队列确保消息有序转发

## 配置说明

config.json 配置示例：
```bash
{
  "bot交流共享群组": {           # 共享群组名称
    "group_name_keywords": [   # 群名关键词列表，群名包含任一关键词则匹配
      "bot交流",
      "大模型"
    ],
    "enable": true              # 是否启用该共享群组
  },
  "测试共享群组": {
    "group_name_keywords": [
      "测试",
      "测试群"
    ],
    "enable": true
  },
  "sync_interval": 3,           # 消息转发间隔时间(秒)
  "ignore_at_bot_msg": true     # 是否忽略@机器人的消息
}
```

## 工作原理

1. 插件启动时会扫描所有群聊，根据配置的关键词将群聊分配到对应的共享群组中
2. 当收到群聊消息时，插件会：
   - 判断消息来源群所属的共享群组
   - 将消息转发到该共享群组内的其他群聊
   - 转发的消息格式为：`[发送者@来源群]: 消息内容`
3. 使用消息队列和独立的发送线程：
   - 确保消息按照接收顺序依次转发
   - 控制消息发送间隔
   - 避免消息发送失败影响其他消息

## 注意事项

1. 目前插件仅支持文本消息的转发
2. 仅支持gewechat channel，需要配置相关参数才能使用
3. 建议合理设置消息发送间隔，避免消息发送过于频繁
4. 当消息队列满时，新的消息将被丢弃
